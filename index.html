<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sistema de Controle de Contratos</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    :root{
      /* Paleta CNC */
      --primary-color:#00478a;     /* azul CNC */
      --primary-dark:#003566;
      --secondary-color:#c4933d;   /* dourado CNC */
      --accent-color:#0ea5e9;      /* azul claro de apoio */
      --danger-color:#ef4444;
      --warning-color:#f59e0b;
      --text-primary:#1f2937;
      --text-secondary:#6b7280;
      --border-color:#e5e7eb;
      --bg-light:#f5f7fb;
      --white:#ffffff;

      --shadow:0 4px 6px -1px rgba(0,0,0,.1);
      --shadow-lg:0 10px 15px -3px rgba(0,0,0,.1);
      --radius:16px;
    }
    body{
      font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
      background:linear-gradient(180deg,#e9f2fb 0%,#f8fafc 100%);
      color:var(--text-primary);
      min-height:100vh;
    }
    .container{max-width:1400px;margin:0 auto;padding:24px}
    .header{
      background:var(--white);
      border:1px solid rgba(0,0,0,.04);
      border-radius:20px;
      padding:28px;
      margin-bottom:24px;
      box-shadow:var(--shadow-lg);
      text-align:center;
    }
    .header h1{
      font-size:2.2rem;
      line-height:1.2;
      background:linear-gradient(135deg,var(--primary-color),var(--secondary-color));
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      margin-bottom:8px;
      font-weight:800;
      letter-spacing:.2px;
    }
    .header p{color:var(--text-secondary)}

    .stats-grid{
      display:grid;gap:16px;margin:20px 0 16px;
      grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
    }
    .stat-card{
      background:var(--white);
      border-radius:var(--radius);
      padding:18px;
      box-shadow:var(--shadow);
      border:1px solid rgba(0,0,0,.05);
    }
    .stat-number{font-size:1.9rem;font-weight:800;margin-bottom:4px}
    .stat-label{color:var(--text-secondary);font-size:.92rem}

    .toolbar{
      background:var(--white);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      border:1px solid rgba(0,0,0,.05);
      padding:14px;
      display:flex;gap:12px;flex-wrap:wrap;align-items:end;
      margin-bottom:18px;
    }
    .toolbar .group{display:flex;gap:8px;flex-wrap:wrap}
    .form-control{
      padding:10px 12px;border:2px solid var(--border-color);
      border-radius:10px;font-size:14px;background:#fff;min-width:180px
    }
    .btn{
      background:var(--primary-color);color:#fff;border:none;
      padding:10px 16px;border-radius:10px;cursor:pointer;
      font-weight:700;letter-spacing:.2px;
      transition:transform .15s ease,box-shadow .15s ease,background .2s ease
    }
    .btn:hover{transform:translateY(-1px);box-shadow:var(--shadow);background:var(--primary-dark)}
    .btn.secondary{background:var(--secondary-color)}
    .btn.ghost{background:#f1f5f9;color:#0f172a}
    .btn.warn{background:var(--warning-color)}
    .btn.danger{background:var(--danger-color)}
    .btn.success{background:var(--accent-color)}
    .spacer{flex:1}

    .nav-tabs{
      display:flex;gap:8px;margin:14px 0;
      background:var(--white);padding:8px;border-radius:14px;
      box-shadow:var(--shadow);border:1px solid rgba(0,0,0,.05);
    }
    .nav-tab{
      flex:1;padding:10px 14px;border-radius:10px;border:none;cursor:pointer;
      background:transparent;color:var(--text-secondary);font-weight:700
    }
    .nav-tab.active{background:var(--primary-color);color:#fff;box-shadow:var(--shadow)}
    .tab-content{display:none}
    .tab-content.active{display:block;animation:fade .25s ease}
    @keyframes fade{from{opacity:0}to{opacity:1}}

    .card{
      background:var(--white);border-radius:var(--radius);
      padding:18px;box-shadow:var(--shadow);
      border:1px solid rgba(0,0,0,.05);
    }
    .card h3{margin-bottom:10px}

    .table-container{overflow:auto;border-radius:12px;border:1px solid var(--border-color)}
    table{width:100%;border-collapse:collapse;background:#fff}
    th,td{padding:12px 14px;border-bottom:1px solid var(--border-color);text-align:left}
    th{background:var(--bg-light);font-weight:700}

    .badge{padding:4px 10px;border-radius:999px;font-size:.75rem;font-weight:800}
    .badge-success{background:#10b981;color:#fff}
    .badge-warning{background:#f59e0b;color:#fff}
    .badge-danger{background:#ef4444;color:#fff}

    .progress-bar{width:100%;height:8px;background:#e2e8f0;border-radius:999px;overflow:hidden}
    .progress-fill{height:100%;background:var(--accent-color);transition:width .2s ease}

        /* Dashboard */
    .dashboard-grid{
      display:grid;gap:16px;margin-bottom:18px;
      grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
    }
    .metric-box{
      background:var(--white);border-radius:var(--radius);
      box-shadow:var(--shadow);padding:18px;text-align:center;
      border:1px solid rgba(0,0,0,.05);
    }
    .metric-box h4{font-size:1rem;margin-bottom:6px;color:var(--text-secondary)}
    .metric-value{font-size:1.8rem;font-weight:800;color:var(--primary-color)}

    .alert{
      background:#eef6ff;border-left:4px solid var(--primary-color);
      padding:12px 14px;border-radius:10px;margin:10px 0
    }
    .alert-danger{background:#fee2e2;border-left-color:var(--danger-color)}
    .alert-warning{background:#fff7ed;border-left-color:var(--warning-color)}
    .alert-success{background:#ecfeff;border-left-color:#06b6d4}

    /* Modal básico controlado via app.js (display block/none) */
    .modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);backdrop-filter:blur(3px);z-index:1000}
    .modal-content{
      position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);
      background:#fff;border-radius:16px;box-shadow:var(--shadow-lg);
      width:95%;max-width:820px;max-height:90vh;overflow:auto;padding:22px
    }
    .modal-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
    .close{background:none;border:none;font-size:22px;color:var(--text-secondary);cursor:pointer}

    /* Estilos dos botões de ação na tabela */
    .action-buttons {
      display: flex;
      gap: 5px;
      flex-wrap: wrap;
    }
    .action-buttons .btn {
      padding: 6px 12px;
      font-size: 12px;
      min-width: auto;
    }

    @media(max-width:768px){
      .stats-grid{grid-template-columns:repeat(2,1fr)}
      .form-control{min-width:140px}
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>Sistema de Controle de Contratos</h1>
      <p>Gestão de contratos, centros de custo e contas contábeis com a identidade da CNC</p>
    </div>

    <div id="alerts"></div>

    <!-- KPIs -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-number" id="totalContratos" style="color:var(--primary-color)">0</div>
        <div class="stat-label">Total de Contratos</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="contratosAtivos" style="color:var(--secondary-color)">0</div>
        <div class="stat-label">Contratos Ativos</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="contratosVencendo" style="color:var(--warning-color)">0</div>
        <div class="stat-label">Vencendo em 30 dias</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="contratosEstouro" style="color:var(--danger-color)">0</div>
        <div class="stat-label">Com Estouro de Saldo</div>
      </div>
    </div>

    <!-- Filtros que o app.js usa -->
    <div class="toolbar">
      <div class="group">
        <input class="form-control" id="filtroFornecedor" placeholder="Fornecedor"/>
        <input class="form-control" id="filtroNumero" placeholder="Número do contrato"/>
        <select class="form-control" id="filtroStatus">
          <option value="">Status</option>
          <option value="ativo">Ativo</option>
          <option value="vencendo">Vencendo</option>
          <option value="vencido">Vencido</option>
          <option value="saldo_baixo">Saldo Baixo</option>
          <option value="inativo">Inativo</option>
        </select>
        <input type="date" class="form-control" id="filtroVencimentoDe" />
        <input type="date" class="form-control" id="filtroVencimentoAte" />
      </div>
      <div class="spacer"></div>
      <div class="group">
        <button class="btn" id="btnAplicarFiltros">Aplicar</button>
        <button class="btn ghost" id="btnLimparFiltros">Limpar</button>
        <button class="btn secondary" id="btnRelatorio">CSV</button>
        <button class="btn success" id="btnNovoContrato">+ Novo Contrato</button>
      </div>
    </div>

    <!-- Abas -->
    <div class="nav-tabs">
      <button id="tabDashboard" class="nav-tab" onclick="showTab('dashboard', this)">Dashboard</button>     
      <button class="nav-tab active" onclick="showTab('contratos', this)">Contratos</button>
      <button class="nav-tab" onclick="showTab('centros', this)">Centros de Custo</button>
      <button class="nav-tab" onclick="showTab('contas', this)">Contas Contábeis</button>
    </div>

        <!-- Conteúdo: Dashboard -->
    <div id="dashboard" class="tab-content">
      <div class="dashboard-grid">
        <div class="metric-box">
          <h4>Contratos Ativos</h4>
          <div class="metric-value" id="dashContratos">0</div>
        </div>
        <div class="metric-box">
          <h4>Valor Total</h4>
          <div class="metric-value" id="dashValor">R$ 0,00</div>
        </div>
        <div class="metric-box">
          <h4>Fornecedores</h4>
          <div class="metric-value" id="dashFornecedores">0</div>
        </div>
      </div>
      <div class="card">
        <h3>Status dos Contratos</h3>
        <canvas id="chartStatus"></canvas>
      </div>
      <div class="card" style="margin-top:16px">
        <h3>Gastos por Mês</h3>
        <canvas id="chartEvolucao"></canvas>
      </div>
      <div class="card" style="margin-top:16px">
        <h3>Top Fornecedores</h3>
        <canvas id="chartFornecedores"></canvas>
      </div>
    </div>

    <!-- Conteúdo: Contratos -->
    <div id="contratos" class="tab-content active">
      <div class="card">
        <h3>Gestão de Contratos</h3>
        <div class="table-container" style="margin-top:12px">
          <table id="contratosTable">
            <thead>
              <tr>
                <th>Número</th>
                <th>Fornecedor</th>
                <th>Centro de Custo</th>
                <th>Valor Total</th>
                <th>Saldo Utilizado</th>
                <th>Vencimento</th>
                <th>Status</th>
                <th style="width:300px">Ações</th>
              </tr>
            </thead>
            <tbody><!-- preenchido via app.js --></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Conteúdo: Centros -->
    <div id="centros" class="tab-content">
      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px">
          <h3>Centros de Custo</h3>
          <button class="btn warn" onclick="openModal('centroModal')">+ Novo Centro</button>
        </div>
        <div class="table-container">
          <table id="centrosTable">
            <thead>
              <tr>
                <th>Código</th>
                <th>Nome</th>
                <th>Responsável</th>
                <th>Email</th>
                <th style="width:180px">Ações</th>
              </tr>
            </thead>
            <tbody><!-- via app.js --></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Conteúdo: Contas -->
    <div id="contas" class="tab-content">
      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px">
          <h3>Contas Contábeis</h3>
          <button class="btn warn" onclick="openModal('contaModal')">+ Nova Conta</button>
        </div>
        <div class="table-container">
          <table id="contasTable">
            <thead>
              <tr>
                <th>Código</th>
                <th>Descrição</th>
                <th>Tipo</th>
                <th style="width:180px">Ações</th>
              </tr>
            </thead>
            <tbody><!-- via app.js --></tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal CONTRATO -->
  <div id="contratoModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="contratoModalTitle">Novo Contrato</h2>
        <button class="close" onclick="closeModal('contratoModal')">&times;</button>
      </div>
        <form id="contratoForm">
          <div class="alert" style="display:none" id="msgContrato"></div>
          <div class="form-grid">
            <div class="form-group">
            <label>Número do Contrato *</label>
            <input id="numeroContrato" class="form-control" required />
            <span class="error"></span>
          </div>
          <div class="form-group">
            <label>Fornecedor *</label>
            <input id="fornecedor" class="form-control" required />
            <span class="error"></span>
          </div>
          <div class="form-group">
            <label>Centro de Custo *</label>
            <select id="centroCustoContrato" class="form-control" required>
              <option value="">Selecione</option>
            </select>
            <span class="error"></span>
          </div>
          <div class="form-group">
            <label>Conta Contábil *</label>
            <select id="contaContabil" class="form-control" required>
              <option value="">Selecione</option>
            </select>
            <span class="error"></span>
          </div>
          <div class="form-group">
            <label>Valor Total (R$) *</label>
            <input id="valorTotal" type="number" step="0.01" class="form-control" required />
            <span class="error"></span>
          </div>
          <div class="form-group">
            <label>Saldo Utilizado (R$)</label>
            <input id="saldoUtilizado" type="number" step="0.01" class="form-control" value="0" />
          </div>
          <div class="form-group">
            <label>Data de Início *</label>
            <input id="dataInicio" type="date" class="form-control" required />
            <span class="error"></span>
          </div>
          <div class="form-group">
            <label>Data de Vencimento *</label>
            <input id="dataVencimento" type="date" class="form-control" required />
            <span class="error"></span>
          </div>
          <div class="form-group form-group--full">
            <label>Observações</label>
            <textarea id="observacoes" rows="3" class="form-control"></textarea>
          </div>
          <div class="form-group" style="display:flex;align-items:center;gap:8px">
            <input type="checkbox" id="contratoAtivo" checked />
            <label for="contratoAtivo">Contrato ativo</label>
          </div>
          <div class="form-group form-group--full">
            <label>Anexos do contrato</label>
            <input id="anexosContrato" type="file" class="form-control" multiple />
            <ul id="listaAnexosContrato"></ul>
          </div>
        </div>
        <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:14px">
          <button type="button" class="btn ghost" onclick="closeModal('contratoModal')">Cancelar</button>
          <button type="submit" class="btn" id="btnSalvarContrato">Salvar</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Modal MOVIMENTOS -->
  <div id="movModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Movimentações do Contrato</h2>
        <button class="close" onclick="closeModal('movModal')">&times;</button>
      </div>

      <div class="alert" id="msgMov" style="display:none"></div>

      <form id="movForm">
        <input type="hidden" id="movContratoId" />
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px;margin-bottom:12px">
          <div>
            <label>Tipo</label>
            <select id="movTipo" class="form-control">
              <option value="saida">Pagamento (Saída)</option>
              <option value="ajuste">Ajuste de Saldo</option>
            </select>
          </div>
          <div>
            <label>Valor (R$)</label>
            <input id="movValor" type="number" step="0.01" class="form-control" required />
          </div>
          <div>
            <label>Data</label>
            <input id="movData" type="date" class="form-control" />
          </div>
          <div style="grid-column:1/-1">
            <label>Observações</label>
            <input id="movObs" class="form-control" />
          </div>
        </div>
        <div style="display:flex;gap:8px;justify-content:flex-end;margin-bottom:12px">
          <button type="button" class="btn ghost" onclick="closeModal('movModal')">Fechar</button>
          <button type="submit" class="btn success">Aplicar Movimentação</button>
        </div>
      </form>

      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>Data</th>
              <th>Tipo</th>
              <th>Valor</th>
              <th>Obs</th>
            </tr>
          </thead>
          <tbody id="tbMov"><!-- via app.js --></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Modal CENTRO -->
  <div id="centroModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="centroModalTitle">Novo Centro de Custo</h2>
        <button class="close" onclick="closeModal('centroModal')">&times;</button>
      </div>
      <form id="centroForm">
        <div class="alert" id="msgCentro" style="display:none"></div>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px">
          <div>
            <label>Código *</label>
            <input id="codigoCentro" class="form-control" required />
          </div>
          <div>
            <label>Nome *</label>
            <input id="nomeCentro" class="form-control" required />
          </div>
          <div>
            <label>Responsável *</label>
            <input id="responsavel" class="form-control" required />
          </div>
          <div>
            <label>Email *</label>
            <input id="emailResponsavel" type="email" class="form-control" required />
          </div>
        </div>
        <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:14px">
          <button type="button" class="btn ghost" onclick="closeModal('centroModal')">Cancelar</button>
          <button type="submit" class="btn">Salvar</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Modal CONTA -->
  <div id="contaModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="contaModalTitle">Nova Conta Contábil</h2>
        <button class="close" onclick="closeModal('contaModal')">&times;</button>
      </div>
      <form id="contaForm">
        <div class="alert" id="msgConta" style="display:none"></div>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px">
          <div>
            <label>Código *</label>
            <input id="codigoConta" class="form-control" required />
          </div>
          <div>
            <label>Descrição *</label>
            <input id="descricaoConta" class="form-control" required />
          </div>
          <div>
            <label>Tipo *</label>
            <select id="tipoConta" class="form-control" required>
              <option value="">Selecione</option>
              <option>Despesa</option>
              <option>Receita</option>
              <option>Ativo</option>
              <option>Passivo</option>
            </select>
          </div>
        </div>
        <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:14px">
          <button type="button" class="btn ghost" onclick="closeModal('contaModal')">Cancelar</button>
          <button type="submit" class="btn">Salvar</button>
        </div>
      </form>
    </div>
  </div>

    <!-- Modal ANEXOS -->
  <div id="anexosModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Anexos</h2>
        <button class="close" onclick="closeModal('anexosModal')">&times;</button>
      </div>
      <ul id="listaAnexosModal"></ul>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:14px">
        <button type="button" class="btn ghost" onclick="closeModal('anexosModal')">Fechar</button>
      </div>
    </div>
  </div>

  <!-- app.js -->
  <script src="js/app.js"></script>
</body>
</html>